{"ast":null,"code":"import WalletConnect from \"@walletconnect/client\";\nimport QRCodeModal from \"@walletconnect/qrcode-modal\";\nimport HttpConnection from \"@walletconnect/http-connection\";\nimport { payloadId, signingMethods, parsePersonalSign, getRpcUrl } from \"@walletconnect/utils\";\n\nconst ProviderEngine = require(\"web3-provider-engine\");\n\nconst CacheSubprovider = require(\"web3-provider-engine/subproviders/cache\");\n\nconst FixtureSubprovider = require(\"web3-provider-engine/subproviders/fixture\");\n\nconst FilterSubprovider = require(\"web3-provider-engine/subproviders/filters\");\n\nconst HookedWalletSubprovider = require(\"web3-provider-engine/subproviders/hooked-wallet\");\n\nconst NonceSubprovider = require(\"web3-provider-engine/subproviders/nonce-tracker\");\n\nconst SubscriptionsSubprovider = require(\"web3-provider-engine/subproviders/subscriptions\");\n\nclass WalletConnectProvider extends ProviderEngine {\n  constructor(opts) {\n    super({\n      pollingInterval: opts.pollingInterval || 8000\n    });\n    this.bridge = \"https://bridge.walletconnect.org\";\n    this.qrcode = true;\n    this.qrcodeModal = QRCodeModal;\n    this.qrcodeModalOptions = undefined;\n    this.rpc = null;\n    this.infuraId = \"\";\n    this.http = null;\n    this.isConnecting = false;\n    this.connected = false;\n    this.connectCallbacks = [];\n    this.accounts = [];\n    this.chainId = 1;\n    this.rpcUrl = \"\";\n\n    this.enable = async () => {\n      const wc = await this.getWalletConnector();\n\n      if (wc) {\n        this.start();\n        this.subscribeWalletConnector();\n        return wc.accounts;\n      } else {\n        throw new Error(\"Failed to connect to WalleConnect\");\n      }\n    };\n\n    this.request = async payload => {\n      return this.send(payload);\n    };\n\n    this.send = async (payload, callback) => {\n      var _a;\n\n      if (typeof payload === \"string\") {\n        const method = payload;\n        let params = callback;\n\n        if (method === \"personal_sign\") {\n          params = parsePersonalSign(params);\n        }\n\n        return this.sendAsyncPromise(method, params);\n      }\n\n      payload = Object.assign({\n        id: payloadId(),\n        jsonrpc: \"2.0\"\n      }, payload);\n\n      if (payload.method === \"personal_sign\") {\n        payload.params = parsePersonalSign(payload.params);\n      }\n\n      if (callback) {\n        this.sendAsync(payload, callback);\n        return;\n      }\n\n      if (payload.method === \"eth_signTypedData_v4\" && ((_a = this.walletMeta) === null || _a === void 0 ? void 0 : _a.name) === \"MetaMask\") {\n        const {\n          result\n        } = await this.handleOtherRequests(payload);\n        return result;\n      } else {\n        return this.sendAsyncPromise(payload.method, payload.params);\n      }\n    };\n\n    this.onConnect = callback => {\n      this.connectCallbacks.push(callback);\n    };\n\n    this.triggerConnect = result => {\n      if (this.connectCallbacks && this.connectCallbacks.length) {\n        this.connectCallbacks.forEach(callback => callback(result));\n      }\n    };\n\n    this.bridge = opts.connector ? opts.connector.bridge : opts.bridge || \"https://bridge.walletconnect.org\";\n    this.qrcode = typeof opts.qrcode === \"undefined\" || opts.qrcode !== false;\n    this.qrcodeModal = opts.qrcodeModal || this.qrcodeModal;\n    this.qrcodeModalOptions = opts.qrcodeModalOptions;\n    this.wc = opts.connector || new WalletConnect({\n      bridge: this.bridge,\n      qrcodeModal: this.qrcode ? this.qrcodeModal : undefined,\n      qrcodeModalOptions: this.qrcodeModalOptions,\n      storageId: opts === null || opts === void 0 ? void 0 : opts.storageId,\n      signingMethods: opts === null || opts === void 0 ? void 0 : opts.signingMethods,\n      clientMeta: opts === null || opts === void 0 ? void 0 : opts.clientMeta\n    });\n    this.rpc = opts.rpc || null;\n\n    if (!this.rpc && (!opts.infuraId || typeof opts.infuraId !== \"string\" || !opts.infuraId.trim())) {\n      throw new Error(\"Missing one of the required parameters: rpc or infuraId\");\n    }\n\n    this.infuraId = opts.infuraId || \"\";\n    this.chainId = (opts === null || opts === void 0 ? void 0 : opts.chainId) || this.chainId;\n    this.initialize();\n  }\n\n  get isWalletConnect() {\n    return true;\n  }\n\n  get connector() {\n    return this.wc;\n  }\n\n  get walletMeta() {\n    return this.wc.peerMeta;\n  }\n\n  async disconnect() {\n    this.close();\n  }\n\n  async close() {\n    const wc = await this.getWalletConnector({\n      disableSessionCreation: true\n    });\n    await wc.killSession();\n    await this.onDisconnect();\n  }\n\n  async handleRequest(payload) {\n    try {\n      let response;\n      let result = null;\n      const wc = await this.getWalletConnector();\n\n      switch (payload.method) {\n        case \"wc_killSession\":\n          await this.close();\n          result = null;\n          break;\n\n        case \"eth_accounts\":\n          result = wc.accounts;\n          break;\n\n        case \"eth_coinbase\":\n          result = wc.accounts[0];\n          break;\n\n        case \"eth_chainId\":\n          result = wc.chainId;\n          break;\n\n        case \"net_version\":\n          result = wc.chainId;\n          break;\n\n        case \"eth_uninstallFilter\":\n          this.sendAsync(payload, _ => _);\n          result = true;\n          break;\n\n        default:\n          response = await this.handleOtherRequests(payload);\n      }\n\n      if (response) {\n        return response;\n      }\n\n      return this.formatResponse(payload, result);\n    } catch (error) {\n      this.emit(\"error\", error);\n      throw error;\n    }\n  }\n\n  async handleOtherRequests(payload) {\n    if (!signingMethods.includes(payload.method) && payload.method.startsWith(\"eth_\")) {\n      return this.handleReadRequests(payload);\n    }\n\n    const wc = await this.getWalletConnector();\n    const result = await wc.sendCustomRequest(payload);\n    return this.formatResponse(payload, result);\n  }\n\n  async handleReadRequests(payload) {\n    if (!this.http) {\n      const error = new Error(\"HTTP Connection not available\");\n      this.emit(\"error\", error);\n      throw error;\n    }\n\n    return this.http.send(payload);\n  }\n\n  formatResponse(payload, result) {\n    return {\n      id: payload.id,\n      jsonrpc: payload.jsonrpc,\n      result: result\n    };\n  }\n\n  getWalletConnector() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      disableSessionCreation = false\n    } = opts;\n    return new Promise((resolve, reject) => {\n      const wc = this.wc;\n\n      if (this.isConnecting) {\n        this.onConnect(x => resolve(x));\n      } else if (!wc.connected && !disableSessionCreation) {\n        this.isConnecting = true;\n        wc.on(\"modal_closed\", () => {\n          reject(new Error(\"User closed modal\"));\n        });\n        wc.createSession({\n          chainId: this.chainId\n        }).then(() => {\n          wc.on(\"connect\", (error, payload) => {\n            if (error) {\n              this.isConnecting = false;\n              return reject(error);\n            }\n\n            this.isConnecting = false;\n            this.connected = true;\n\n            if (payload) {\n              this.updateState(payload.params[0]);\n            }\n\n            this.emit(\"connect\");\n            this.triggerConnect(wc);\n            resolve(wc);\n          });\n        }).catch(error => {\n          this.isConnecting = false;\n          reject(error);\n        });\n      } else {\n        if (!this.connected) {\n          this.connected = true;\n          this.updateState(wc.session);\n        }\n\n        resolve(wc);\n      }\n    });\n  }\n\n  async subscribeWalletConnector() {\n    const wc = await this.getWalletConnector();\n    wc.on(\"disconnect\", error => {\n      if (error) {\n        this.emit(\"error\", error);\n        return;\n      }\n\n      this.onDisconnect();\n    });\n    wc.on(\"session_update\", (error, payload) => {\n      if (error) {\n        this.emit(\"error\", error);\n        return;\n      }\n\n      this.updateState(payload.params[0]);\n    });\n  }\n\n  async onDisconnect() {\n    await this.stop();\n    this.emit(\"close\", 1000, \"Connection closed\");\n    this.emit(\"disconnect\", 1000, \"Connection disconnected\");\n    this.connected = false;\n  }\n\n  async updateState(sessionParams) {\n    const {\n      accounts,\n      chainId,\n      networkId,\n      rpcUrl\n    } = sessionParams;\n\n    if (!this.accounts || accounts && this.accounts !== accounts) {\n      this.accounts = accounts;\n      this.emit(\"accountsChanged\", accounts);\n    }\n\n    if (!this.chainId || chainId && this.chainId !== chainId) {\n      this.chainId = chainId;\n      this.emit(\"chainChanged\", chainId);\n    }\n\n    if (!this.networkId || networkId && this.networkId !== networkId) {\n      this.networkId = networkId;\n      this.emit(\"networkChanged\", networkId);\n    }\n\n    this.updateRpcUrl(this.chainId, rpcUrl || \"\");\n  }\n\n  updateRpcUrl(chainId) {\n    let rpcUrl = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    const rpc = {\n      infuraId: this.infuraId,\n      custom: this.rpc || undefined\n    };\n    rpcUrl = rpcUrl || getRpcUrl(chainId, rpc);\n\n    if (rpcUrl) {\n      this.rpcUrl = rpcUrl;\n      this.updateHttpConnection();\n    } else {\n      this.emit(\"error\", new Error(`No RPC Url available for chainId: ${chainId}`));\n    }\n  }\n\n  updateHttpConnection() {\n    if (this.rpcUrl) {\n      this.http = new HttpConnection(this.rpcUrl);\n      this.http.on(\"payload\", payload => this.emit(\"payload\", payload));\n      this.http.on(\"error\", error => this.emit(\"error\", error));\n    }\n  }\n\n  sendAsyncPromise(method, params) {\n    return new Promise((resolve, reject) => {\n      this.sendAsync({\n        id: payloadId(),\n        jsonrpc: \"2.0\",\n        method,\n        params: params || []\n      }, (error, response) => {\n        if (error) {\n          reject(error);\n          return;\n        }\n\n        resolve(response.result);\n      });\n    });\n  }\n\n  initialize() {\n    this.updateRpcUrl(this.chainId);\n    this.addProvider(new FixtureSubprovider({\n      eth_hashrate: \"0x00\",\n      eth_mining: false,\n      eth_syncing: true,\n      net_listening: true,\n      web3_clientVersion: `WalletConnect/v1.x.x/javascript`\n    }));\n    this.addProvider(new CacheSubprovider());\n    this.addProvider(new SubscriptionsSubprovider());\n    this.addProvider(new FilterSubprovider());\n    this.addProvider(new NonceSubprovider());\n    this.addProvider(new HookedWalletSubprovider(this.configWallet()));\n    this.addProvider({\n      handleRequest: async (payload, next, end) => {\n        try {\n          const {\n            error,\n            result\n          } = await this.handleRequest(payload);\n          end(error, result);\n        } catch (error) {\n          end(error);\n        }\n      },\n      setEngine: _ => _\n    });\n  }\n\n  configWallet() {\n    return {\n      getAccounts: async cb => {\n        try {\n          const wc = await this.getWalletConnector();\n          const accounts = wc.accounts;\n\n          if (accounts && accounts.length) {\n            cb(null, accounts);\n          } else {\n            cb(new Error(\"Failed to get accounts\"));\n          }\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signMessage([msgParams.from, msgParams.data]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processPersonalMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signPersonalMessage([msgParams.data, msgParams.from]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processSignTransaction: async (txParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signTransaction(txParams);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processTransaction: async (txParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.sendTransaction(txParams);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processTypedMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signTypedData([msgParams.from, msgParams.data]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      }\n    };\n  }\n\n}\n\nexport default WalletConnectProvider;","map":{"version":3,"mappings":"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","names":["WalletConnect","QRCodeModal","HttpConnection","payloadId","signingMethods","parsePersonalSign","getRpcUrl","ProviderEngine","require","CacheSubprovider","FixtureSubprovider","FilterSubprovider","HookedWalletSubprovider","NonceSubprovider","SubscriptionsSubprovider","WalletConnectProvider","constructor","opts","pollingInterval","undefined","wc","getWalletConnector","start","subscribeWalletConnector","accounts","Error","payload","send","callback","method","params","sendAsyncPromise","id","jsonrpc","sendAsync","walletMeta","_a","name","result","handleOtherRequests","connectCallbacks","push","length","forEach","bridge","connector","qrcode","qrcodeModal","qrcodeModalOptions","storageId","clientMeta","rpc","infuraId","trim","chainId","initialize","isWalletConnect","peerMeta","disconnect","close","disableSessionCreation","killSession","onDisconnect","handleRequest","response","_","formatResponse","error","emit","includes","startsWith","handleReadRequests","sendCustomRequest","http","Promise","resolve","reject","isConnecting","onConnect","x","connected","on","createSession","then","updateState","triggerConnect","catch","session","stop","sessionParams","networkId","rpcUrl","updateRpcUrl","custom","updateHttpConnection","addProvider","eth_hashrate","eth_mining","eth_syncing","net_listening","web3_clientVersion","configWallet","next","end","setEngine","getAccounts","cb","processMessage","msgParams","signMessage","from","data","processPersonalMessage","signPersonalMessage","processSignTransaction","txParams","signTransaction","processTransaction","sendTransaction","processTypedMessage","signTypedData"],"sources":["../../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}